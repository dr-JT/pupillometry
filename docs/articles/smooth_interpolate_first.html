<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Smooth or Interpolation First? • pupillometry</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><!-- docsearch --><script src="../docsearch.js"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/docsearch.js/2.6.3/docsearch.min.css" integrity="sha256-QOSRU/ra9ActyXkIBbiIB144aDBdtvXBcNc3OTNuX/Q=" crossorigin="anonymous">
<link href="../docsearch.css" rel="stylesheet">
<script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/jquery.mark.min.js" integrity="sha256-4HLtjeVgH0eIB3aZ9mLYF6E8oU5chNdjU6p6rrXpl9U=" crossorigin="anonymous"></script><meta property="og:title" content="Smooth or Interpolation First?">
<meta property="og:description" content="pupillometry">
<meta property="og:image" content="https://dr-jt.github.io/pupillometry/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">pupillometry</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.5.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li class="divider">
    <li class="dropdown-header">How To</li>
    <li>
      <a href="../articles/pupil_preprocess.html">Use pupil_preprocess()</a>
    </li>
    <li>
      <a href="../articles/gui.html">Use the GUI</a>
    </li>
    <li>
      <a href="../articles/pupillometry_functions.html">Build Your Own Sequence of Pupillometry Functions</a>
    </li>
    <li>
      <a href="../articles/message_markers.html">Use Message Markers</a>
    </li>
    <li class="divider">
    <li class="dropdown-header">Example Data Sets</li>
    <li>
      <a href="../articles/example_data.html">Example Data Set</a>
    </li>
    <li>
      <a href="../articles/example_data_w_out_messages.html">What if My Data Doesn't Have Message Markers?</a>
    </li>
    <li class="divider">
    <li class="dropdown-header">More Details</li>
    <li>
      <a href="../articles/preprocessing_options.html">Preprocessing Options</a>
    </li>
    <li>
      <a href="../articles/smooth_interpolate_first.html">Smooth or Interpolation First?</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/dr-JT/pupillometry/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
<form class="navbar-form navbar-right hidden-xs hidden-sm" role="search">
        <div class="form-group">
          <input type="search" class="form-control" name="search-input" id="search-input" placeholder="Search..." aria-label="Search for..." autocomplete="off">
</div>
      </form>
      
    </div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Smooth or Interpolation First?</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/dr-JT/pupillometry/blob/master/vignettes/smooth_interpolate_first.Rmd"><code>vignettes/smooth_interpolate_first.Rmd</code></a></small>
      <div class="hidden name"><code>smooth_interpolate_first.Rmd</code></div>

    </div>

    
    
<p>One question when considering preprocessing methods is whether to first smooth the data or first interpolate missing values?</p>
<p>Below, I demonstrate that at least when using this package to preprocess pupil data it is better to smooth the data before applying a <strong>cubic-spline</strong> interpolation. There is not as big of a difference if you are applying a <strong>linear</strong> interpolation. Therefore, it is advisable to apply smoothing before interpolation.</p>
<div id="example-data" class="section level2">
<h2 class="hasAnchor">
<a href="#example-data" class="anchor"></a>Example Data</h2>
<p>The example data is from a simple pitch discrimination task I administered to myself. There were only six trials. Trials 2 and 6 had the largest chuncks of missing data so I decided to test out whether applying smoothing or interpolation first changes the preprocessed data.</p>
<p>From these examples, it can be seen that if you are gonig to apply a <strong>cubic-spline</strong> interpolation, then you should also apply smoothing and it is important that you choose <code>method_first = "smooth"</code>. Otherwise the data get overly distorted if you apply interpolation first (see Trial 6).</p>
<p>These data come from a pitch discrimination task as described in the <a href="https://dr-jt.github.io/pupillometry/articles/example_data.html">Example Data Set</a> article. Time = 0 is the onset of the first tone.</p>
<hr>
<p>In all the figures, at some point the time-series “lines” might overlap considerably and it only looks like one color is there. In fact, all colored lines are present during those periods, they are just overlapping. If smoothing was applied, then <code>smooth.window = 500</code>.</p>
<p>On Trial 6 there are a couple of “major” gaps of missing pupil data. You can see that if you use <code>cubic-spline</code> interpolation without smoothing (<em>Figure 1</em>), then the interpolated values are exaggerated and most likely unrealistic (see the period of 0 - 500 ms). It is very unlikely that pupil size is decreasing and then increasing by over 1 mm within a 500 ms interval. Thee <code>cubic-spline</code> interpolation might be modeling too much high frequency noise in the data. You can see that the <code>linear</code> interpolation does not suffer from the same problem. However, if there was truly a decrease during that interval then the <code>linear</code> interpolation is not capturing that.</p>
<p><img src="../reference/figures/Trial6-interpolation.type.png" align="center"></p>
<p><em>Figure 1. Interpolation only. Cubic-spline interpolation (pink line) results in unrealistic interpolated values</em></p>
<hr>
<p><em>Figure 2</em> shows the same trial but with smoothing applied. With either <code>method_first = "smooth"</code> (<strong>green line</strong>) or <code>method_first = "interpolate"</code> (<strong>pink line</strong>). Both lines used <strong>cubic-spline interpolation</strong>, the only difference is whether smoothing was applied first or not. You can see that applying smoothing before a cubice-spline interpolation avoids the issue seen in <em>Figure 1</em> and the pink line in <em>Figure 2</em>.</p>
<p><img src="../reference/figures/Trial6--cubic-spline-hann.png" align="center"></p>
<p><em>Figrue 2. Applying smoothing before cubic-spline interpolation (green line) results in more realistic values than applying smoothing after cubic-spline interpolation (pink line)</em></p>
<p><br><br></p>
<hr>
<p>There is not as big of a difference for <code>linear</code> interpolation.</p>
<p>For <code>linear</code> interpolation, the issue of applying smoothing first or not is not as big of an issue (<em>Figure 3</em>).</p>
<p><img src="../reference/figures/Trial6--linear-hann.png" align="center"></p>
<p><em>Figure 3. Applying smoothing before linear interpolation (green line) results in slightly different values then applying smoothing after linear interpolation (pink line). If anything, applying smoothing after linear interpolation is slightly more accurate. However, after aggregation over trials the result would not be different between the two.</em></p>
<p><br><br></p>
<hr>
<p>And here is Trial 6 if you were to do smoothing but no interpolation (<em>Figure 4</em>)</p>
<p><img src="../reference/figures/Trial6-smooth.type.png" align="center"></p>
<p><em>Figure 4. This just shows the difference between the two smoothing methods available.</em></p>
<p><br><br></p>
<hr>
<p>Trial 2 shows a similar pattern when you use cubic-spline interpolation (<em>Figure 5</em>).</p>
<p><img src="../reference/figures/Trial2--cubic-spline-hann.png" align="center"></p>
<p><em>Figure 5. Applying smoothing before cubic-spline interpolation (green line) results in more realistic values than applying smoothing after cubic-spline interpolation (pink line)</em></p>
<hr>
<p>These comparisons demonstrate the importance of being careful what types of preprocessing paramteres you specify. Based on this small sample of data it is suggested, that if you are going to apply an interpolation method, that you first apply smoothing, particularly if you are applying cubic-spline interpolation.</p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by <a href="http://englelab.gatech.edu/jason">Jason Tsukahara</a>.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.</p>
</div>

      </footer>
</div>

  
<script src="https://cdnjs.cloudflare.com/ajax/libs/docsearch.js/2.6.1/docsearch.min.js" integrity="sha256-GKvGqXDznoRYHCwKXGnuchvKSwmx9SRMrZOTh2g4Sb0=" crossorigin="anonymous"></script><script>
  docsearch({
    
    
    apiKey: 'API_KEY',
    indexName: 'INDEX_NAME',
    inputSelector: 'input#search-input.form-control',
    transformData: function(hits) {
      return hits.map(function (hit) {
        hit.url = updateHitURL(hit);
        return hit;
      });
    }
  });
</script>
</body>
</html>
