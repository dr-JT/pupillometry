<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Use pupil_preprocess() â€¢ pupillometry</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><!-- docsearch --><script src="../docsearch.js"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/docsearch.js/2.6.3/docsearch.min.css" integrity="sha256-QOSRU/ra9ActyXkIBbiIB144aDBdtvXBcNc3OTNuX/Q=" crossorigin="anonymous">
<link href="../docsearch.css" rel="stylesheet">
<script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/jquery.mark.min.js" integrity="sha256-4HLtjeVgH0eIB3aZ9mLYF6E8oU5chNdjU6p6rrXpl9U=" crossorigin="anonymous"></script><meta property="og:title" content="Use pupil_preprocess()">
<meta property="og:description" content="pupillometry">
<meta property="og:image" content="https://dr-jt.github.io/pupillometry/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">pupillometry</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.5.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li class="divider">
    <li class="dropdown-header">How To</li>
    <li>
      <a href="../articles/pupil_preprocess.html">Use pupil_preprocess()</a>
    </li>
    <li>
      <a href="../articles/gui.html">Use the GUI</a>
    </li>
    <li>
      <a href="../articles/pupillometry_functions.html">Build Your Own Sequence of Pupillometry Functions</a>
    </li>
    <li>
      <a href="../articles/message_markers.html">Use Message Markers</a>
    </li>
    <li class="divider">
    <li class="dropdown-header">Example Data Sets</li>
    <li>
      <a href="../articles/example_data.html">Example Data Set</a>
    </li>
    <li>
      <a href="../articles/example_data_w_out_messages.html">What if My Data Doesn't Have Message Markers?</a>
    </li>
    <li class="divider">
    <li class="dropdown-header">More Details</li>
    <li>
      <a href="../articles/preprocessing_options.html">Preprocessing Options</a>
    </li>
    <li>
      <a href="../articles/smooth_interpolate_first.html">Smooth or Interpolation First?</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/dr-JT/pupillometry/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
<form class="navbar-form navbar-right hidden-xs hidden-sm" role="search">
        <div class="form-group">
          <input type="search" class="form-control" name="search-input" id="search-input" placeholder="Search..." aria-label="Search for..." autocomplete="off">
</div>
      </form>
      
    </div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="pupil_preprocess_files/header-attrs-2.5/header-attrs.js"></script><link href="pupil_preprocess_files/anchor-sections-1.0/anchor-sections.css" rel="stylesheet">
<script src="pupil_preprocess_files/anchor-sections-1.0/anchor-sections.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Use pupil_preprocess()</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/dr-JT/pupillometry/blob/master/vignettes/pupil_preprocess.Rmd"><code>vignettes/pupil_preprocess.Rmd</code></a></small>
      <div class="hidden name"><code>pupil_preprocess.Rmd</code></div>

    </div>

    
    
<p><strong><code><a href="../reference/pupil_preprocess.html">pupil_preprocess()</a></code> is a wrapper around the other functions to allow full preprocessing of raw pupil data using a single function.</strong></p>
<p>Using this method, you will need to pass many arguments to the <code><a href="../reference/pupil_preprocess.html">pupil_preprocess()</a></code> function that specifies all the details and preprocessing options.</p>
<p><code><a href="../reference/pupil_preprocess.html">pupil_preprocess()</a></code> will be performed on an entire <code>import_dir</code> directory of raw data files that match a certain <code>pattern</code> in their filename. The preprocessed data will be saved to a specified <code>output_dir</code> directory.</p>
<div id="workflow" class="section level2">
<h2 class="hasAnchor">
<a href="#workflow" class="anchor"></a>Workflow</h2>
<p>The overall workflow of <code><a href="../reference/pupil_preprocess.html">pupil_preprocess()</a></code> is:</p>
<ol style="list-style-type: decimal">
<li>
<p><strong>Read</strong> in raw data files <code><a href="../reference/pupil_read.html">pupil_read()</a></code></p>
<ul>
<li>If <code>tracking_file</code> is supplied will also add message markers to the data</li>
</ul>
</li>
<li>
<p>Clean up raw data files and more</p>
<ul>
<li><p>Set <strong>Timing</strong> variable to be relative to onset of each trial. <code><a href="../reference/set_timing.html">set_timing()</a></code></p></li>
<li><p><strong>Correlate</strong> left and right pupil size (if both eyes were recorded from). <code><a href="../reference/pupil_cor.html">pupil_cor()</a></code></p></li>
<li><p><strong>Select</strong> either left or right pupil data (if both eyes were recorded from). <code><a href="../reference/select_eye.html">select_eye()</a></code></p></li>
</ul>
</li>
<li><p><strong>Deblink</strong> data. <code><a href="../reference/pupil_deblink.html">pupil_deblink()</a></code></p></li>
<li><p><strong>Smooth</strong> (if specified). <code><a href="../reference/pupil_smooth.html">pupil_smooth()</a></code></p></li>
<li><p><strong>Interpolate</strong> (if specified). <code><a href="../reference/pupil_interpolate.html">pupil_interpolate()</a></code></p></li>
<li><p><strong>Baseline Correct</strong> (if specified). <code><a href="../reference/pupil_baselinecorrect.html">pupil_baselinecorrect()</a></code></p></li>
<li><p>Remove trials with too much <strong>Missing Data</strong>. <code><a href="../reference/pupil_missing.html">pupil_missing()</a></code></p></li>
<li><p><strong>Merges</strong> files into a single merged file (if specified). <code><a href="../reference/pupil_merge.html">pupil_merge()</a></code></p></li>
</ol>
<p>A final preprocessed data file will be saved for every original raw data file.</p>
<p>If <code>output_steps == TRUE</code> a data file will be saved after steps 3, 4, and 5. Before saving the data file at each of these steps, the final two steps 6 and 7 are performed. This results in baseline corrected and missing data removed files before each major preprocessing step. This is obviously not necessary and so <code>output_steps = FALSE</code> is the default and will only save one final preprocessed data file per subject. Saving a data file after each preprocessing steps would allow you to analyze your data at different stages to assess the influence of the preprocessing methods you chose.</p>
</div>
<div id="message-markers" class="section level2">
<h2 class="hasAnchor">
<a href="#message-markers" class="anchor"></a>Message Markers</h2>
<p>You will need to supply message markers to correctly preprocess your data. This image is a representation of what the message markers <code>start_tracking.message</code>, <code>trial_onset.message</code>, and <code>bc_onset.message</code> correspond to. For further detail see <a href="https://dr-jt.github.io/pupillometry/articles/example_data.html">Example Data Set</a> and <a href="https://dr-jt.github.io/pupillometry/articles/message_markers.html">Message Markers</a> Articles.</p>
<p><img src="../reference/figures/message_markers_1.png" align="center"></p>
</div>
<div id="script-template" class="section level2">
<h2 class="hasAnchor">
<a href="#script-template" class="anchor"></a>Script Template</h2>
<p>You can copy and paste the following code into a script and use it as a template.</p>
<div class="sourceCode" id="cb1"><pre class="downlit">
<span class="co">## Preprocessing parameters</span>

<span class="co"># File Import Information</span>
<span class="kw">import_dir</span> <span class="op">&lt;-</span> <span class="st">"data/Raw"</span>
<span class="kw">pattern</span> <span class="op">&lt;-</span> <span class="st">".txt"</span>
<span class="kw">taskname</span> <span class="op">&lt;-</span> <span class="st">"Attention_Task"</span>
<span class="kw">timing_file</span> <span class="op">&lt;-</span> <span class="kw">NULL</span>

<span class="co"># Eye trackers save the subject number information in different ways and is not</span>
<span class="co"># always easy to obtain. For SMI Red250m eye trackers this is extracted from the</span>
<span class="co"># datafile name. For SR-Research Eyelink1000 eye trackers this is extracted from </span>
<span class="co"># the column name with the subject ID. For SMI eye trackers you MUST identify a</span>
<span class="co"># unique subj_prefix pattern and subj_suffix pattern that surrounds the </span>
<span class="co"># subject # in the datafile name/subject ID column.</span>

<span class="kw">subj_prefix</span> <span class="op">&lt;-</span> <span class="st">"n_"</span>
<span class="kw">subj_suffix</span> <span class="op">&lt;-</span> <span class="st">"-"</span>

<span class="co"># File Output Information</span>
<span class="kw">output_dir</span> <span class="op">&lt;-</span> <span class="st">"data/Preprocessed"</span>
<span class="kw">output_steps</span> <span class="op">&lt;-</span> <span class="fl">FALSE</span>
<span class="kw">files_merge</span> <span class="op">&lt;-</span> <span class="fl">FALSE</span>

<span class="co"># Eye tracker Information</span>
<span class="kw">eyetracker</span> <span class="op">&lt;-</span> <span class="st">"smi"</span>
<span class="kw">hz</span> <span class="op">&lt;-</span> <span class="fl">250</span>
<span class="kw">eye_use</span> <span class="op">&lt;-</span> <span class="st">"left"</span>
<span class="kw">px_to_mm.conversion</span> <span class="op">&lt;-</span> <span class="kw">NULL</span>

<span class="co"># Message Marker Information</span>
<span class="kw">start_tracking.message</span> <span class="op">&lt;-</span> <span class="st">"StartTracking.bmp"</span>
<span class="kw">start_tracking.match</span> <span class="op">&lt;-</span> <span class="st">"exact"</span>
<span class="kw">trial_onset.message</span> <span class="op">&lt;-</span> <span class="st">"Cue"</span> 
<span class="kw">trial_onset.match</span> <span class="op">&lt;-</span> <span class="st">"exact"</span>
<span class="kw">pretrial.duration</span> <span class="op">&lt;-</span> <span class="fl">1000</span>
<span class="kw">bc_onset.message</span> <span class="op">&lt;-</span> <span class="st">"Stimulus"</span>
<span class="kw">bc_onset.match</span> <span class="op">&lt;-</span> <span class="st">"exact"</span>

<span class="co"># Preprocessing Options</span>
<span class="kw">deblink_extend</span> <span class="op">&lt;-</span> <span class="fl">100</span>
<span class="kw">smooth</span> <span class="op">&lt;-</span> <span class="st">"hann"</span>
<span class="kw">smooth.window</span> <span class="op">&lt;-</span> <span class="fl">500</span>
<span class="kw">interpolate</span> <span class="op">&lt;-</span> <span class="st">"linear"</span>
<span class="kw">interpolate.maxgap</span> <span class="op">&lt;-</span> <span class="fl">750</span>
<span class="kw">method_first</span> <span class="op">&lt;-</span> <span class="st">"smooth"</span>
<span class="kw">bc</span> <span class="op">&lt;-</span> <span class="st">"subtractive"</span>
<span class="kw">pre_bc.duration</span> <span class="op">&lt;-</span> <span class="fl">200</span>
<span class="kw">missing_allowed</span> <span class="op">&lt;-</span> <span class="fl">.30</span>

<span class="co"># Misc.</span>
<span class="kw">include_col</span> <span class="op">&lt;-</span> <span class="kw">NULL</span>
<span class="kw">trial_exclude</span> <span class="op">&lt;-</span> <span class="kw">NULL</span>

<span class="co">############################</span>

<span class="fu"><a href="../reference/pupil_preprocess.html">pupil_preprocess</a></span>(import_dir = <span class="kw">import_dir</span>, pattern = <span class="kw">pattern</span>, taskname = <span class="kw">taskname</span>,
                 subj_prefix = <span class="kw">subj_prefix</span>, subj_suffix = <span class="kw">subj_suffix</span>, 
                 timing_file = <span class="kw">timing_file</span>, output_dir = <span class="kw">output_dir</span>, 
                 output_steps = <span class="kw">output_steps</span>, files_merge = <span class="kw">files_merge</span>, 
                 eyetracker = <span class="kw">eyetracker</span>, hz = <span class="kw">hz</span>, eye_use = <span class="kw">eye_use</span>, 
                 px_to_mm.conversion = <span class="kw">px_to_mm.conversion</span>, 
                 start_tracking.message = <span class="kw">start_tracking.message</span>, 
                 start_tracking.match = <span class="kw">start_tracking.match</span>,
                 trial_onset.message = <span class="kw">trial_onset.message</span>, 
                 trial_onset.match = <span class="kw">trial_onset.match</span>,
                 pretrial.duration = <span class="kw">pretrial.duration</span>, 
                 bc_onset.message = <span class="kw">bc_onset.message</span>, 
                 bc_onset.match = <span class="kw">bc_onset.match</span>, 
                 deblink_extend = <span class="kw">deblink_extend</span>, 
                 smooth = <span class="kw">smooth</span>, smooth.window = <span class="kw">smooth.window</span>, 
                 interpolate = <span class="kw">interpolate</span>, 
                 interpolate.maxgap = <span class="kw">interpolate.maxgap</span>, 
                 method_first = <span class="kw">method_first</span>, bc = <span class="kw">bc</span>, 
                 pre_bc.duration = <span class="kw">pre_bc.duration</span>, 
                 missing_allowed = <span class="kw">missing_allowed</span>, include_col = <span class="kw">include_col</span>, 
                 trial_exclude = <span class="kw">trial_exclude</span>)
</pre></div>
<p>For any of the parameters that do not apply to your data or preprocessing steps, then you can just set them to <code>NULL</code> (e.g.Â <code>timing_file &lt;- NULL</code>)</p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by <a href="http://englelab.gatech.edu/jason">Jason Tsukahara</a>.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  
<script src="https://cdnjs.cloudflare.com/ajax/libs/docsearch.js/2.6.1/docsearch.min.js" integrity="sha256-GKvGqXDznoRYHCwKXGnuchvKSwmx9SRMrZOTh2g4Sb0=" crossorigin="anonymous"></script><script>
  docsearch({
    
    
    apiKey: 'API_KEY',
    indexName: 'INDEX_NAME',
    inputSelector: 'input#search-input.form-control',
    transformData: function(hits) {
      return hits.map(function (hit) {
        hit.url = updateHitURL(hit);
        return hit;
      });
    }
  });
</script>
</body>
</html>
