<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Preprocessing of Pupil Time Series Data • pupillometry</title>
<!-- jquery --><script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script><!-- Font Awesome icons --><link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/1.7.1/clipboard.min.js" integrity="sha384-cV+rhyOuRHc9Ub/91rihWcGmMmCXDeksTtCihMupQHSsi8GIIRDG0ThDc3HGQFJ3" crossorigin="anonymous"></script><!-- sticky kit --><script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script><!-- pkgdown --><link href="pkgdown.css" rel="stylesheet">
<script src="pkgdown.js"></script><meta property="og:title" content="Preprocessing of Pupil Time Series Data">
<meta property="og:description" content="The package contains various functions for different steps in the preprocessing 
    pipeline of pupil data, such as interpolation or baseline correction. The preprocess() 
    function is wrapper around the other functions to allow preprocessing of an entire folder
    containing individual raw pupil time series data in one line of code.">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-home">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="index.html">pupillometry</a>
        <span class="label label-default" data-toggle="tooltip" data-placement="bottom" title="Released package">0.8.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="reference/index.html">Reference</a>
</li>
<li>
  <a href="news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/dr-JT/pupillometry">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="contents col-md-9">
    <div id="pupillometry" class="section level1">
<div class="page-header"><h1 class="hasAnchor">
<a href="#pupillometry" class="anchor"></a>pupillometry</h1></div>
<p>An R Package to preprocess pupil data</p>
<p>The package contains various functions for different steps in the preprocessing pipeline, such as interpolation or baseline correction.</p>
<p>The pre-processing steps are based on what has commonly been used in the literature and suggested by</p>
<p>Mathôt, S., Fabius, J., Van Heusden, E., &amp; Van der Stigchel, S. (2018). Safe and sensible preprocessing and baseline correction of pupil-size data. Behavior research methods, 50(1), 94-106.</p>
<div id="eyetrackers" class="section level2">
<h2 class="hasAnchor">
<a href="#eyetrackers" class="anchor"></a>Eyetrackers</h2>
<p>Currently the package only supports data exported from BeGaze using an SMI eye-tracker. Other eye-trackers will be included in future updates.</p>
</div>
<div id="preprocess" class="section level2">
<h2 class="hasAnchor">
<a href="#preprocess" class="anchor"></a>preprocess()</h2>
<p>preprocess() is a wrapper around the other functions to allow full preprocessing of pupil data using a single function.</p>
<p>As such, you will need to pass many arguments to the preprocess() function that specifies all the details and preprocessing options.</p>
<p>The overall workflow of preprocess() is:</p>
<p>For each eyetracking file in a specified directory</p>
<ol>
<li>
<strong>Convert</strong> “messy” raw data file to a standardized “tidy” raw data file</li>
<li>
<strong>Save</strong> the “tidy” raw data file</li>
<li>Set and evaluate amount of <strong>missing samples</strong> per trial</li>
<li>Correlate left and right pupil size (If both eyes were recorded from)</li>
<li>Choose to keep only left or right pupil data (If both eyes were recorded from)</li>
<li>Set <strong>Timing</strong> variable to be relative to onset of each trial</li>
<li>
<strong>Save</strong> data at this stage*</li>
<li><strong>Interpolate</strong></li>
<li>
<strong>Save</strong> data at this stage*</li>
<li><strong>Smooth</strong></li>
<li>
<strong>Save</strong> data at this stage*</li>
</ol>
<p>* When data is saved at these stages the following preprocessing steps may follow:</p>
<ol>
<li><strong>Baseline Correct</strong></li>
<li><strong>Down Sample</strong></li>
</ol>
<p>What this does is saves a data file at each stage of preprocessing. That way you have a baseline corrected/downsampled file at each stage of pre-processing. This can be useful if you originally specified a pre-processing step, such as smoothing, but then later decide you do not want to use that pre-processing method - you will already have the pre-processed (including baseline correction/down sampling) data file prior to that step. Or you may wish to compare how your results change depending on what pre-processing steps you perform.</p>
<div id="example" class="section level3">
<h3 class="hasAnchor">
<a href="#example" class="anchor"></a>Example</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">## Preprocessing parameters
import &lt;-<span class="st"> "./raw_data"</span>
export &lt;-<span class="st"> "./preprocessed_data"</span>
task &lt;-<span class="st"> "PVT"</span>
pattern &lt;-<span class="st"> "*.txt"</span>
eyetracker &lt;-<span class="st"> "smi"</span>
eye.recorded &lt;-<span class="st"> "both"</span>
eye.use &lt;-<span class="st"> "left"</span>
hz &lt;-<span class="st"> </span><span class="dv">250</span>
startrecording.message &lt;-<span class="st"> "default"</span>
startrecording.match &lt;-<span class="st"> "exact"</span>
trialonset.message &lt;-<span class="st"> "Beep"</span>
pretrial.duration &lt;-<span class="st"> </span><span class="dv">2000</span>
velocity &lt;-<span class="st"> ""</span>
margin &lt;-<span class="st"> ""</span>
interpolate &lt;-<span class="st"> </span><span class="ot">TRUE</span>
interpolate.type &lt;-<span class="st"> "cubic-spline"</span>
interpolate.maxgap &lt;-<span class="st"> </span><span class="dv">300</span>
smooth &lt;-<span class="st"> </span><span class="ot">FALSE</span>
smooth.type &lt;-<span class="st"> ""</span>
smooth.window &lt;-<span class="st"> ""</span>
bc &lt;-<span class="st"> </span><span class="ot">TRUE</span>
baselineoffset.message &lt;-<span class="st"> "Target"</span>
bc.duration &lt;-<span class="st"> </span><span class="dv">200</span>
downsample.binlength &lt;-<span class="st"> </span><span class="dv">20</span>
subj.prefix &lt;-<span class="st"> "default"</span>
subset &lt;-<span class="st"> "default"</span>
trial.exclude &lt;-<span class="st"> </span><span class="kw">c</span>()
############################

<span class="kw"><a href="reference/preprocess.html">preprocess</a></span>(<span class="dt">import =</span> import, <span class="dt">pattern =</span> pattern, <span class="dt">export =</span> export, <span class="dt">taskname =</span> task, <span class="dt">eyetracker =</span> eyetracker, 
           <span class="dt">eye.recorded =</span> eye.recorded, <span class="dt">eye.use =</span> eye.use, <span class="dt">hz =</span> hz,
           <span class="dt">startrecording.message =</span> startrecording.message, <span class="dt">startrecording.match =</span> startrecording.match,
           <span class="dt">trialonset.message =</span> trialonset.message, <span class="dt">pretrial.duration =</span> pretrial.duration,
           <span class="dt">velocity =</span> velocity, <span class="dt">margin =</span> margin,
           <span class="dt">interpolate =</span> interpolate, <span class="dt">interpolate.type =</span> interpolate.type, <span class="dt">interpolate.maxgap =</span> interpolate.maxgap,
           <span class="dt">smooth =</span> smooth, <span class="dt">smooth.type =</span> smooth.type, <span class="dt">smooth.window =</span> smooth.window,
           <span class="dt">bc =</span> bc, <span class="dt">baselineoffset.message =</span> baselineoffset.message, <span class="dt">bc.duration =</span> bc.duration,
           <span class="dt">downsample.binlength =</span> downsample.binlength,
           <span class="dt">subj.prefix =</span> subj.prefix, <span class="dt">subset =</span> subset, <span class="dt">trial.exclude =</span> trial.exclude)</code></pre></div>
</div>
</div>
<div id="message-markers" class="section level2">
<h2 class="hasAnchor">
<a href="#message-markers" class="anchor"></a>Message Markers</h2>
<p>Your data file should conatain messages that mark the onset/offset of critical stimuli and events</p>
<p>For preprocess() these are the message markers you need to know</p>
<div id="startrecording-message" class="section level3">
<h3 class="hasAnchor">
<a href="#startrecording-message" class="anchor"></a>startrecording.message</h3>
<p>Eye-tracking systems use different defaults for how it marks the start of recording on a trial. This is not necessarily when the trial begins - simply whent he eye-tracker starts recording.</p>
<p>The SMI default is : “# Message: StartTracking.bmp”</p>
<p>This parameter can be set to “default” to use the eyetracker default. If you are not using the default message then you need to specify the custom string you used.</p>
</div>
<div id="trialonset-message-and-pretrial-duration" class="section level3">
<h3 class="hasAnchor">
<a href="#trialonset-message-and-pretrial-duration" class="anchor"></a>trialonset.message and pretrial.duration</h3>
<p>trialonset.message is the message that marks the onset of a trial. If you included a fixation at the start of every trial, then the trial onset should correspond to the stimulus after the fixation. The fixation period will be treated as a pre-trial period.</p>
<p>The duration of the pre-trial period is set relative to the timing of the trialonset.message</p>
<p>For instance if pretrial.duration = 2000, then the 2000 milliseconds before trialonset.message will be marked as a pre-trial period. This duration typically corresponds to the duration of the fixation period. It should definitely not exceed the startrecording.message.</p>
</div>
<div id="baselineoffset-message" class="section level3">
<h3 class="hasAnchor">
<a href="#baselineoffset-message" class="anchor"></a>baselineoffset.message</h3>
<p>baselineoffset.message is the message that marks the offset of the baseline period and the start of the critical task period that needs to be baseline corrected.</p>
</div>
</div>
<div id="pupil-interpolate" class="section level2">
<h2 class="hasAnchor">
<a href="#pupil-interpolate" class="anchor"></a>pupil.interpolate()</h2>
<p>Different interpolation options are available</p>
<div id="type" class="section level3">
<h3 class="hasAnchor">
<a href="#type" class="anchor"></a>type</h3>
<ul>
<li>linear</li>
<li>cubic-spline</li>
</ul>
</div>
<div id="maxgap" class="section level3">
<h3 class="hasAnchor">
<a href="#maxgap" class="anchor"></a>maxgap</h3>
<ul>
<li>The maximum gap (in milliseconds) of missing pupil data that will not be interpolated over. Any gaps larger than this value will not be interpolated.</li>
</ul>
</div>
</div>
<div id="pupil-smooth" class="section level2">
<h2 class="hasAnchor">
<a href="#pupil-smooth" class="anchor"></a>pupil.smooth()</h2>
<p>Different smoothing options are available</p>
<div id="type-1" class="section level3">
<h3 class="hasAnchor">
<a href="#type-1" class="anchor"></a>type</h3>
<ul>
<li>hann</li>
<li>mwa (moving window average)</li>
</ul>
</div>
<div id="window" class="section level3">
<h3 class="hasAnchor">
<a href="#window" class="anchor"></a>window</h3>
<ul>
<li>hanning or moving average window size</li>
</ul>
</div>
</div>
</div>
  </div>

  <div class="col-md-3" id="sidebar">
    <div class="links">
<h2>Links</h2>
<ul class="list-unstyled">
<li>Browse source code at <br><a href="https://github.com/dr-JT/pupillometry">https://​github.com/​dr-JT/​pupillometry</a>
</li>
<li>Report a bug at <br><a href="NA">NA</a>
</li>
</ul>
</div>
<div class="license">
<h2>License</h2>
<ul class="list-unstyled">
<li>NA</li>
</ul>
</div>

  </div>
</div>


      <footer><div class="copyright">
  <p>Developed by .</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://pkgdown.r-lib.org/">pkgdown</a>.</p>
</div>

      </footer>
</div>

  

  </body>
</html>
